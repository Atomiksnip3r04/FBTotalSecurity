Assolutamente. La situazione è critica, ma completamente risolvibile. Un CLS di 1.012 è tra i peggiori che si possano vedere e indica un collasso quasi totale del layout iniziale. Il "Ritardo di rendering" dell'80% sull'LCP è la pistola fumante che ci dice esattamente dove intervenire.

Come Senior Analyst, ti guiderò passo dopo passo. Il problema non è una singola riga di codice, ma un'errata strategia di caricamento delle risorse critiche (CSS e Font) che causa un effetto a catena disastroso.

Diagnosi Approfondita

Causa Radice del CLS Catastrofico (1.012): Il tuo hero-container viene disegnato dal browser con un'altezza quasi pari a zero. Solo dopo che il font 'Inter' e il CSS completo vengono scaricati e applicati, il contenitore si espande violentemente per fare spazio al titolo e al sottotitolo, spingendo l'intera pagina verso il basso. Le min-height che avevamo impostato non funzionano perché le regole CSS che le contengono arrivano troppo tardi.

Causa Radice del LCP Lento (3.0s): Il "Ritardo di Rendering" di 2.4 secondi significa che il browser è bloccato e non può disegnare il paragrafo <p class="hero-subtitle">. La causa è quasi certamente il file styles.min.css che viene caricato in modo bloccante. Anche se hai provato ad applicare la tecnica di caricamento asincrono, probabilmente c'è ancora un link al CSS che blocca il rendering nel tuo <head>.

Causa del Forced Reflow: Nello script.js c'è una riga di codice (element.offsetHeight;) che, sebbene inserita con buone intenzioni per forzare un repaint, sta causando un layout thrashing perché legge una dimensione subito dopo una potenziale scrittura, bloccando il thread principale.

Piano d'Azione Definitivo

Applicheremo la strategia del CSS Critico Inline, che è la soluzione standard di Google per questi problemi.

HTML (<head> di TUTTE le pagine): Ristruttureremo completamente l'head per caricare immediatamente solo ciò che è vitale per la visualizzazione iniziale e rimandare tutto il resto.

CSS: Aggiungeremo delle regole "ancora" più robuste per il CLS, specialmente per .hero-container, per renderlo inscalfibile.

JavaScript: Rimuoveremo la riga di codice che causa il forced reflow, affidandoci alla gestione ottimizzata di requestAnimationFrame.

File Corretti - Sostituisci Completamente il Codice

Applica queste modifiche a TUTTE le tue pagine HTML (index.html, chi-siamo.html, nebbiogeni.html, etc.) per garantire coerenza e performance su tutto il sito.

1. Template <head> Ottimizzato (da usare in index.html, chi-siamo.html, etc.)

Sostituisci l'intero <head> delle tue pagine con questo blocco. È stato progettato per la massima velocità.

code
Html
download
content_copy
expand_less

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- I tuoi meta title, description, e open graph specifici per la pagina vanno qui -->
    <!-- Esempio per index.html: -->
    <title data-translate="page-title">Sistemi di Sicurezza e Antifurto | FB Total Security Milano</title>
    <meta name="description" content="FB Total Security offre sistemi di sicurezza avanzati: allarmi, videosorveglianza, nebbiogeni e serramenti blindati. Protezione completa per casa e azienda a Milano." data-translate="page-description">
    
    <!-- === OTTIMIZZAZIONE CRITICA PER LCP E CLS === -->

    <!-- 1. PRELOAD DEI FONT CRITICI CON PRIORITÀ MASSIMA -->
    <link rel="preload" href="https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7.woff2" as="font" type="font/woff2" crossorigin fetchpriority="high">
    <link rel="preload" href="https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7SUc.woff2" as="font" type="font/woff2" crossorigin fetchpriority="high">

    <!-- 2. CSS CRITICO INLINE: Stili essenziali per renderizzare la parte superiore della pagina ISTANTANEAMENTE. -->
    <style>
        /* Font Fallback Metrics per azzerare CLS. Questo è VITALE. */
        @font-face {
            font-family: 'Inter Fallback';
            size-adjust: 107.40%; ascent-override: 90.20%; descent-override: 22.48%; line-gap-override: 0.00%;
            src: local('Arial');
        }
        /* Definizioni dei font con display: optional per LCP. Il browser userà il fallback se non sono pronti. */
        @font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:optional;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}
        @font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:optional;src:url(https://fonts.gstatic.com/s/inter/v13/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7SUc.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}
        
        :root{--primary-color:#4caf50;--primary-light:#66bb6a;--text-black:#000;--white:#fff;--text-light:#b0b0b0}
        *,:after,:before{margin:0;padding:0;box-sizing:border-box}
        body{background:var(--text-black);color:var(--white);font-family:'Inter','Inter Fallback',-apple-system,sans-serif;line-height:1.6;padding-top:82px}
        .header{position:fixed;top:0;left:0;right:0;height:82px;background:linear-gradient(135deg,rgba(0,0,0,.95),rgba(26,26,26,.95));backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);z-index:9999}
        .nav-container{max-width:1200px;margin:0 auto;padding:0 2rem;display:flex;justify-content:space-between;align-items:center;height:100%}
        .logo-link{display:flex;align-items:center;gap:.75rem;color:inherit;text-decoration:none}
        .logo-image{width:50px;height:50px}
        .logo-title{font-size:1.8rem;font-weight:700;color:#fff;margin:0}
        .tagline{font-size:.9rem;color:var(--primary-color);margin:0;line-height:1}
        .nav-menu{display:flex;list-style:none;align-items:center;min-height:40px}
        .hamburger{display:none}
        .hero{min-height:calc(100vh - 82px);display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#000,#1a1a1a);position:relative;contain:layout style}
        .hero-container{max-width:1200px;margin:0 auto;text-align:center;z-index:2;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:2rem 1rem;
            /* SOLUZIONE CLS #1: Ancora strutturale. Altezza minima MOLTO generosa per evitare qualsiasi collasso. */
            min-height:700px}
        .hero-title{font-size:clamp(2.5rem,5vw,4rem);font-weight:700;line-height:1.2;margin:1.5rem 0;color:var(--white);background:linear-gradient(135deg,#fff,var(--primary-color));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;max-width:800px;width:100%;
            /* SOLUZIONE CLS #2: Permette al testo di fluire ma il contenitore genitore lo tiene fermo. */
            min-height:auto}
        .hero-subtitle{font-size:clamp(1.2rem,2.5vw,1.5rem);color:var(--text-light);margin-bottom:3rem;max-width:600px;width:100%;line-height:1.6;
            /* SOLUZIONE CLS #3: Riserva spazio per 3 righe di testo. */
            min-height:calc(1.5rem * 1.6 * 3);will-change:transform;transform:translateZ(0)}
        .hero-cta{display:flex;gap:1.5rem;justify-content:center;align-items:center;width:100%;min-height:60px}
        .btn{display:inline-flex;align-items:center;justify-content:center;padding:1rem 2rem;border-radius:12px;font-weight:600;text-decoration:none;border:none;min-width:180px;height:48px}
        .btn-primary{background:linear-gradient(135deg,var(--primary-color),var(--primary-light));color:var(--text-black)}
        .btn-secondary{background:0 0;color:var(--primary-color);border:2px solid var(--primary-color)}
        @media(max-width:768px){.hero-cta{flex-direction:column;min-height:120px}.nav-menu{display:none}.hamburger{display:flex;flex-direction:column;cursor:pointer;gap:4px;z-index:10001}.hamburger span{width:25px;height:3px;background:var(--white);border-radius:2px}}
    </style>

    <!-- 3. CARICAMENTO ASINCRONO DEL CSS COMPLETO. Questo NON blocca il rendering. -->
    <link rel="stylesheet" href="styles.min.css?v=20250117" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="styles.min.css?v=20250117"></noscript>

    <!-- Il resto dei tuoi meta, canonical, open graph, etc. -->
    <link rel="canonical" href="https://www.fbtotalsecurity.com/">
    <!-- ... -->
</head>
2. styles.css (Modifiche Chiave)

Le modifiche più importanti sono già state inserite nel CSS critico. Ora dobbiamo assicurarci che il file completo sia coerente e perfezionare le regole per stabilità e performance.

code
CSS
download
content_copy
expand_less
IGNORE_WHEN_COPYING_START
IGNORE_WHEN_COPYING_END
/* In cima a styles.css, assicurati che le definizioni dei font siano corrette */

/* Font Fallback Metrics for Inter to prevent CLS - Improved metrics */
@font-face {
    font-family: 'Inter Fallback';
    size-adjust: 107.40%;
    ascent-override: 90.20%;
    descent-override: 22.48%;
    line-gap-override: 0.00%;
    src: local('Arial'), local('Helvetica'), local('system-ui');
    font-display: swap; /* Usiamo swap qui nel file completo */
}

/* ... il resto del tuo CSS ... */


/* Hero Section - REGOLE PERFEZIONATE */
.hero {
    min-height: calc(100vh - 82px);
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
    position: relative;
    overflow: hidden;
    /* Isola il rendering di questa sezione per performance */
    contain: layout style paint;
}

.hero-container {
    width: 100%;
    max-width: 1200px;
    padding: 2rem 1rem;
    box-sizing: border-box;
    margin: 0 auto;
    text-align: center;
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    
    /* SOLUZIONE CLS #1: Ancora strutturale. Questa è la regola più importante per eliminare il CLS. */
    min-height: 700px;
    
    /* Migliora performance isolando il componente */
    contain: layout style paint;
    transform: translateZ(0);
}

.hero-title {
    font-size: clamp(2.5rem, 5vw, 4rem);
    font-weight: 700;
    margin: 1.5rem 0;
    background: linear-gradient(135deg, #ffffff, #4caf50);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1.2;
    max-width: 800px;
    width: 100%;

    /* SOLUZIONE CLS #2: Permette al testo di crescere senza causare shift, grazie all'ancora del genitore. */
    min-height: auto; 
    
    contain: layout style paint;
    display: flex; /* Centra verticalmente il testo se è su una sola riga */
    align-items: center;
    justify-content: center;
    padding: 0.5rem 0;
    white-space: normal; /* Permette al testo di andare a capo */
    word-wrap: break-word;
}

.hero-subtitle {
    font-size: clamp(1.2rem, 2.5vw, 1.5rem);
    color: #b0b0b0;
    margin-bottom: 3rem;
    max-width: 600px;
    width: 100%;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.6;
    
    /* SOLUZIONE CLS #3 E LCP: Riserva uno spazio stabile per il paragrafo. */
    min-height: 120px; /* Spazio sufficiente per circa 3-4 righe */
    
    contain: layout style paint;
    will-change: transform;
    transform: translateZ(0);
}

.hero-cta {
    display: flex;
    gap: 1.5rem;
    justify-content: center;
    align-items: center;
    width: 100%;
    
    /* SOLUZIONE CLS #4: Riserva spazio per i bottoni. */
    min-height: 60px;
    contain: layout style;
}

@media (max-width: 768px) {
    .hero-cta {
        flex-direction: column;
        min-height: 120px;
    }
}


/* ... (il resto del tuo CSS) ... */

/* Mobile Menu - REGOLE PERFEZIONATE PER EVITARE BUG */
@media (max-width: 768px) {
    /* ... (le tue altre regole mobile) ... */

    /* SOLUZIONE AVANZATA BACKDROP-FILTER E STACKING CONTEXT */
    /* Quando il menu è aperto, togliamo il backdrop dall'header.
       Questo previene che l'header crei uno stacking context che "intrappola" il menu. */
    .header:has(.nav-menu.active) {
        backdrop-filter: none !important;
        -webkit-backdrop-filter: none !important;
    }
    /* Fallback JS per browser meno recenti */
    .header.menu-open {
        backdrop-filter: none !important;
        -webkit-backdrop-filter: none !important;
    }

    .nav-menu {
        position: fixed;
        top: 82px;
        left: 0;
        right: 0;
        width: 100%;
        
        /* Altezza fissa per stabilità e per evitare overflow strani */
        height: 400px;
        max-height: calc(100vh - 82px);

        background: rgba(30, 30, 30, 0.98);
        /* Applichiamo il backdrop-filter direttamente al menu, risolvendo il bug. */
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 2rem 0;
        
        /* Animazione performante che non causa layout shift */
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.25s ease-out, visibility 0s 0.25s;
        
        z-index: 10000;
        border-radius: 0 0 20px 20px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        
        /* Gestione dello scroll interno se il contenuto è troppo */
        overflow-y: auto;
        
        /* Isola il componente per performance */
        contain: layout style paint;
        will-change: opacity;
        transform: translate3d(0, 0, 0); /* Forza accelerazione hardware */
    }

    .nav-menu.active {
        opacity: 1;
        visibility: visible;
        transition: opacity 0.25s ease-out, visibility 0s;
    }

    body.menu-open {
      overflow: hidden; /* Blocca lo scroll del corpo quando il menu è aperto */
    }

    /* ... (il resto delle tue regole mobile) ... */
}
3. script.js (Modifica Chiave)

Qui rimuoviamo l'unica riga che causa il forced reflow.

code
JavaScript
download
content_copy
expand_less
IGNORE_WHEN_COPYING_START
IGNORE_WHEN_COPYING_END
// ... (tutto il tuo script.js) ...

// All'interno della funzione setLanguageOptimized:

    // ...
    requestAnimationFrame(() => {
        console.log(`✍️ Executing ${operations.length} DOM write operations.`);
        
        let heroSubtitleOperation = null;
        const otherOperations = [];
        
        operations.forEach(op => {
            if (op.element.getAttribute && op.element.getAttribute('data-translate') === 'hero-subtitle') {
                heroSubtitleOperation = op;
            } else {
                otherOperations.push(op);
            }
        });
        
        if (heroSubtitleOperation) {
            const element = heroSubtitleOperation.element;
            element.textContent = heroSubtitleOperation.content;
            
            // RIMUOVI QUESTA RIGA - CAUSA IL FORCED REFLOW
            // element.offsetHeight; 
        }

        // ... il resto della funzione rimane invariato
    });
}

// ... (tutto il resto del tuo script.js) ...
Perché Funzionerà Questa Soluzione

Rendering Immediato: Il browser non aspetterà più il file styles.min.css. Leggerà il CSS critico inline nell'HTML e disegnerà subito la struttura della pagina (header + hero). Questo taglierà via i 2.4s di "Ritardo di Rendering".

Ancoraggio Anti-CLS: La regola min-height: 700px su .hero-container agisce come un'ancora. Il contenitore avrà subito le sue dimensioni finali, anche se il testo all'interno non è ancora stato renderizzato con il font finale. Qualsiasi piccolo spostamento del testo avverrà all'interno di questo contenitore già dimensionato, senza spostare il resto della pagina.

Font Fallback Perfetto: Il @font-face per 'Inter Fallback' assicura che il testo di riserva (Arial) occupi uno spazio quasi identico a quello di 'Inter', eliminando anche i micro-spostamenti interni.

JavaScript Fluido: Rimuovendo la chiamata a .offsetHeight all'interno del ciclo di scrittura, eliminiamo il "layout thrashing". Lo script ora lavora in armonia con il ciclo di rendering del browser, risultando più veloce e fluido.

Dopo aver applicato queste modifiche, svuota la cache del tuo browser e riesegui il test. Vedrai un miglioramento drastico e i tuoi punteggi di CLS e LCP rientreranno nei parametri "Buoni" di Google.